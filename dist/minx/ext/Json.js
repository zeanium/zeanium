!function(f){f.json=f.Class({static:!0,methods:{serialize:function(n){return Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&")},format:function(e,n,t){if(!n)return n;for(var c=null,r=null,a=escape(n),i=f.extend({prefix:"${",suffix:"}"},t),o=escape(i.prefix)+"([^%>]+)?"+escape(i.suffix),s=new RegExp(o,"i");c=s.exec(a);){switch(r=f.path(e,c[1].trim()),f.type(r)){case"array":r=r.join("");break;case"object":r=JSON.stringify(r);break;case"function":r=r.call(null,e,n,t)}a=a.replace(s,r)}return unescape(a)}}})}(zn);