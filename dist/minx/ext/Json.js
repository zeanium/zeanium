!function(u){u.json=u.Class({static:!0,methods:{serialize:function(n){return Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&")},format:function(e,n,t){if(!n)return n;for(var i=null,c=null,r=escape(n),a=u.extend({prefix:"${",suffix:"}"},t),o=escape(a.prefix)+"([^%>]+)?"+escape(a.suffix),s=new RegExp(o,"i");i=s.exec(r);){switch(c=__builtin__.path(e,i[1].trim()),u.type(c)){case"array":c=c.join("");break;case"object":c=JSON.stringify(c);break;case"function":c=c.call(null,e,n,t)}r=r.replace(s,c)}return unescape(r)}}})}(zn);